{% extends "base.html" %}
{% import "mapStyle.html" as mapStyle %}
{% block head %}
    <title>Ou trouver des aire-de-jeux, liste des aire-de-jeux pour le département
        {{ lettre_departement }}, {{ departement }} </title>
    <meta name="description" content="Liste le nombre d'aire-de-jeux enregistrées par commune dans le département
       {{ lettre_departement }}, {{ departement }} ">
{% endblock %}
{% block menu %}
    <li class="menu" style="cursor: pointer">
        <a href='{{host}}/créerAireDeJeux'>Ajouter</a>
    </li>
    <li class="menu" style="cursor: pointer">
        <a href='{{host}}/aireDeJeux'>Liste Aire de jeux</a>
    </li>
{% endblock %}
{% block content %}
<div id="title" class="highlight title_detail">
    <div id="ville">{{ lettre_departement }}</div>
</div>
<div class="conteneur-map">
    <div id="map"></div>
</div>
<div id="debloquerMap" onclick="active_map();" style="visibility: hidden">débloquer</div>
<div class="liste_communes">
    {% for commune in liste_communes %}
        <div class="commune" >
            <a href="{{host}}/aireDeJeux/{{ departement }}/{{commune.nom}}">
                {{commune.nom}}: {{commune.nbr_aire_de_jeux}}</a>
        </div>
    {% endfor %}
</div>
<script type="text/javascript">
    {{ mapStyle.script("None", 15) }}
    function initMap(centre_carte) {
        initialize({{ liste_communes[0].coordonnees.lat }}, {{ liste_communes[0].coordonnees.lon }});
        initMarker();
        map.fitBounds(bounds);
    }
    console.log(bounds);
    function initMarker() {
        {% for commune in liste_communes %}
            {% if commune.coordonnees.lat %}
                {% set text = commune.nom + ", aire-de-jeux: " + commune.nbr_aire_de_jeux|string %}
                {{ mapStyle.addMarker(commune.coordonnees, host, departement + "/" + commune.nom, text) }}
            {% endif %}
        {% endfor %}
    }


</script>
<script async defer
         src="https://maps.googleapis.com/maps/api/js?callback=initMap">
</script>
{% endblock %}